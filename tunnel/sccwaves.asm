

;--------------------------------------------------------
_WAVESSCC:                                               ; 15 instruments
 
	; empty
   	; 01_piano.wav
   	; 02_harpsch.wav
   	; 03_harp.wav
	; 04_strgs.wav
   	; 05_slwstr.wav
   	; 06_flute.wav
	; incbin "sccwavestouse\04_ldtrump.bin"
	; incbin "sccwavestouse\05_lead.bin"
	; incbin "sccwavestouse\06_orgue.bin"
    ; 07_fltvib.wav
    ; 08_trmpt.wav
    ; 09_strpzz.wav
    ; 10_clst.wav
    ; 11_mrmb.wav
    ; 12_vln.wav
    ; 13_vlnvb.wav
    ; 14_snrdr.wav
	; 15_aaaaaaa.wav
	; incbin "sccwavestouse\13_bass1.bin"
	; incbin "sccwavestouse\14_scbass.bin"
	; incbin "sccwavestouse\15_venbass.bin"
	
	; same as above but included as text
    db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
    db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
    db 0xF2,0xEB,0xEA,0xD1,0xDB,0xD5,0xDB,0xCD,0xCA,0xEE,0xE1,0x06,0x04,0x0A,0x11,0x1A
    db 0x08,0xFE,0x08,0xFF,0x05,0x15,0x1B,0x1B,0x35,0x36,0x1F,0x2E,0x26,0x07,0xFE,0xF0
    db 0x2B,0x1E,0x0F,0x0B,0xFA,0xF8,0xEC,0xEA,0xED,0xFB,0x02,0xF8,0x03,0xF8,0xED,0xF2
    db 0xEF,0xE7,0xFD,0xF6,0x0E,0x0B,0x00,0x08,0xEF,0xDF,0xF0,0xE5,0x01,0x21,0x2F,0x3A
    db 0x3B,0x3B,0x32,0x26,0x19,0x0F,0xFE,0xEA,0xDA,0xCD,0xD1,0xDF,0xE4,0xE9,0xF5,0x03
    db 0x17,0x2D,0x3A,0x39,0x28,0x0D,0xF5,0xDF,0xD0,0xC8,0xC1,0xC7,0xE0,0xFE,0x1B,0x31
    db 0x00,0xF0,0xE0,0xD0,0xC0,0xB0,0xA0,0x90,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80
    db 0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x7F,0x70,0x60,0x50,0x40,0x30,0x20,0x10
    db 0xAA,0xAA,0xAA,0xAA,0xEE,0xEE,0xEE,0xEE,0xEE,0xFF,0xFF,0xFF,0xFF,0xCC,0xCC,0xCC
    db 0xCC,0xC5,0x55,0x55,0x55,0x77,0x77,0x77,0x77,0x88,0x88,0x88,0x88,0x88,0x88,0x88
    db 0x00,0x68,0x48,0x18,0x48,0x68,0x28,0x00,0x48,0x77,0x58,0x08,0x28,0x38,0x00,0xB8
    db 0x08,0x58,0x00,0xE8,0xF8,0x00,0xB8,0x98,0xC8,0x08,0xE8,0xA8,0xC8,0xF8,0xC8,0xA8
    db 0x3B,0x3F,0x3C,0x2F,0x1E,0x10,0x0A,0x08,0x04,0x00,0xFA,0xF4,0xF0,0xF2,0xF6,0xF8
    db 0xF7,0xF0,0xE8,0xE1,0xDB,0xD7,0xD0,0xCB,0xCE,0xD9,0xEA,0xFF,0x11,0x21,0x2E,0x37
    db 0x00,0x00,0xFE,0xFF,0x01,0x03,0x06,0x04,0xFF,0xFA,0xF0,0xE4,0xDB,0xDC,0xFA,0x29
    db 0xC0,0x23,0x01,0x03,0x04,0x05,0x00,0xFC,0xFC,0xFF,0x02,0x01,0xF8,0xF5,0xF8,0xFD
    db 0xF3,0x04,0x1B,0x17,0x10,0x17,0x14,0x16,0x16,0x04,0xFE,0xE7,0xD5,0xD7,0xD8,0xE6
    db 0xF3,0x01,0x1B,0x2B,0x3A,0x3A,0x26,0x17,0x05,0xEC,0xDD,0xE0,0xE0,0xDE,0xE2,0xE5
    db 0xF0,0x07,0x17,0x1F,0x2E,0x23,0x2B,0x18,0x0E,0x05,0xE6,0xE4,0xD6,0xCF,0xD7,0xDD
    db 0xEF,0x03,0x0D,0x20,0x23,0x2D,0x2B,0x20,0x1A,0x00,0xF7,0xE4,0xD4,0xD6,0xD1,0xDD
    db 0xFE,0xD6,0xC1,0xCB,0xDD,0xE4,0xDD,0xD3,0xD1,0xD2,0xD4,0xDB,0xE5,0xE8,0xE9,0xF6
    db 0x0A,0x10,0x00,0xF9,0x0C,0x20,0x20,0x20,0x2E,0x34,0x25,0x13,0x0D,0x0F,0x07,0xF3
    db 0x06,0xD8,0x00,0x0F,0xF1,0xDB,0xEF,0x03,0x0C,0x2E,0xF5,0x17,0x14,0xE5,0x06,0x15
    db 0xD4,0xE4,0xD3,0xD3,0x12,0x01,0xF5,0x31,0x13,0xF6,0x25,0x20,0x0F,0x13,0xDF,0xF4
    db 0x80,0x8E,0xA0,0xC0,0xE0,0x00,0x20,0x3F,0x3E,0x3C,0x3A,0x37,0x31,0x29,0x20,0x1C
    db 0x10,0x00,0xE6,0xC0,0xD0,0x00,0x20,0x3F,0x10,0xE0,0x80,0xC0,0x00,0x20,0x00,0x90
    db 0xF0,0xB0,0xA0,0x98,0xAE,0x8A,0x86,0x94,0x80,0x90,0x80,0xAC,0xA6,0xAC,0xC2,0xDC
    db 0xEC,0x14,0x36,0x6C,0x6A,0x7E,0x6A,0x7F,0x72,0x4C,0x22,0x36,0x42,0x18,0x30,0x08
    db 0x00,0x40,0x7F,0x40,0x01,0xC0,0x81,0xC0,0x01,0x40,0x7F,0x40,0x01,0xC0,0x01,0x40
    db 0x01,0xE0,0x01,0x20,0x01,0xF0,0x01,0x10,0x01,0xFF,0xFF,0xFF,0xFF,0x40,0x40,0x40



;-------------------------------------
;  scc echoes for PT3
;-------------------------------------
SCC_REG     EQU 009880h           ;SCC ADDRESS FUNCTION

SCCROUT:
        ;Frequencies
		
		; call en_scc
		; ret	z
        ld  a,03Fh
        ld  (Bank3),a

        LD  HL,(AYREGS_CPY+0)       ; A-> ch 1 
        LD  (SCC_REG+0),HL
        LD  HL,(AYREGS_CPY+2)       ; C-> ch 2
        LD  (SCC_REG+2),HL
        LD  HL,(AYREGS_CPY+4)       ; B-> ch 3
        LD  (SCC_REG+4),HL

		;VOLUMES

        ld      a,(AYREGS_CPY+8)
        ld      (SCC_REG+0x0A),a    ; A-> ch 1 
        ld      a,(AYREGS_CPY+9)
        LD      (SCC_REG+0x0B),A    ; C-> ch 2
        ld      a,(AYREGS_CPY+10)
        LD      (SCC_REG+0x0C),A    ; B-> ch 3

		;MIXER

        ld      a,(AYREGS_CPY+7)
        xor     7        
        and     7
        ld      (SCC_REG+0x0F),a

		; call en_slot
        RET


;-------------------------------------
; A-> ch 1 
; B-> ch 2
; C-> ch 3


; setsccwaves:
    ; di
	; call en_scc
	; ret	z
	
    ; ld      a,3fh
    ; ld      (Bank3),a

    ; ld      de,0x09800
    ; ld      a,(wchA)                            ; A->ch1
    ; call    sccchan                             

    ; ld      a,(wchB)                            ; B->ch2
    ; call    sccchan

    ; ld      a,(wchC)                            ; C->ch3
    ; call    sccchan

   	; call en_slot
	; ret


probewavechanges:
   	; call en_scc
	; ret	z
	exx
	push   hl         
	push   de         

	ld  hl,OSmplA

	ld  a,(ChanA+29)
	cp  (hl)
	call  nz,changeA

	inc hl
	ld  a,(ChanB+29)
	cp  (hl)
	call  nz,changeB

	inc hl
	ld  a,(ChanC+29)
	cp  (hl)
	call  nz,changeC

	pop    de         
	pop    hl         
	exx               

	; call en_slot
    ret


changeA:
    ld      (hl),a
    call    samp2wav
    ld      (wchA),a
    ld      de,0x09800                      ; A->ch1
    jp      1f
    
changeB:
    ld      (hl),a
    call    samp2wav
    ld      (wchB),a
    ld      de,0x09800+32*1                 ; B->ch2
    jp      1f

changeC:
    ld      (hl),a
    call    samp2wav
    ld      (wchC),a
    ld      de,0x09800+32*2                 ; C->ch3

1:
    ld      c,a
    ld      a,3fh
    ld      (Bank3),a
    ld      a,c

sccchan:
    push    hl
    ld      l,a
    ld      h,0
[4]	add     hl,hl
    ld      bc, _WAVESSCC
    add     hl,bc
    ld      bc,32
    ldir
    pop     hl
    ret




samp2wav:
	exx
	ld hl,_waves
	rrca
	ld e,a
	ld d,0
	add   hl,de
	ld    a,(hl)
	add   a,a
	exx
	ret
     
en_scc:
	ld	a,[SCC]
	inc	a
	ret	z			; no scc
	in	a,(0xA8)	; Leemos el registro principal de slots
	ld	(curslot),a	; save it
	ld	e,a
	ld	a,(SCC)
	and	0x03		; Nos fijamos en el slot primario
[4]	add	a,a
	ld	d,a
	ld	a,e			; registro principal de slots
	and	11001111b
	or	d
	out (0xA8),a
	ret
	
en_slot:
	ld	a,(curslot)
	out (0xA8),a
	ret
